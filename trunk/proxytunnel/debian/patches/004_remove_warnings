--- a/ptstream.c
+++ b/ptstream.c
@@ -159,16 +159,14 @@
 /* Initiate an SSL handshake on this stream and encrypt all subsequent data */
 int stream_enable_ssl(PTSTREAM *pts) {
 #ifdef USE_SSL
-	SSL_METHOD *meth;
 	SSL *ssl;
 	SSL_CTX *ctx;
 	
 	/* Initialise the connection */
 	SSLeay_add_ssl_algorithms();
-	meth = SSLv3_client_method();
 	SSL_load_error_strings();
 
-	ctx = SSL_CTX_new (meth);
+	ctx = SSL_CTX_new (SSLv3_client_method());
 	ssl = SSL_new (ctx);
 	SSL_set_rfd (ssl, stream_get_incoming_fd(pts));
 	SSL_set_wfd (ssl, stream_get_outgoing_fd(pts));	
